{% extends "base.html" %}
{% block content %}
<div class="card">
    <h3>Yeni Hedef Ekle</h3>
    <form method="POST" action="{{ url_for('enqueue_target_route') }}">
        <div class="form-group">
            <label>Hedef URL veya URN:</label>
            <input type="text" name="target_url" required placeholder="https://linkedin.com/feed/update/...">
        </div>
        <div class="form-group">
            <label>Hedef URN (isteğe bağlı, URL'den çıkarılacak):</label>
            <input type="text" name="target_urn" placeholder="urn:li:share:...">
        </div>
        <div class="form-group">
            <label>Bağlam (isteğe bağlı):</label>
            <textarea name="context" rows="3" placeholder="Bu gönderiye neden yorum yapmak istiyorsunuz?"></textarea>
        </div>
        <button type="submit" class="button">Kuyruğa Ekle</button>
    </form>
</div>

<div class="card">
    <h3>Onay Bekleyenler ({{ pending|length }})</h3>
    {% for item in pending %}
    <div style="border-bottom: 1px solid var(--border-color); padding: 15px 0;">
        <p><strong>URL:</strong> <a href="{{ item.target_url }}" target="_blank">{{ item.target_url }}</a></p>
        <p><strong>Önerilen Yorum:</strong></p>
        <blockquote style="margin-left: 10px; border-left: 3px solid #ccc; padding-left: 10px; font-style: italic;">
            {{ item.suggested_comment }}
        </blockquote>
        <p><small>Oluşturulma: {{ item.created_at }}</small></p>
        <form method="POST" action="{{ url_for('approve_item', item_id=item.id) }}" style="display: inline;">
            <button type="submit" class="button" style="background-color: var(--success-color);">Onayla</button>
        </form>
        <form method="POST" action="{{ url_for('reject_item', item_id=item.id) }}" style="display: inline;">
            <button type="submit" class="button danger">Reddet</button>
        </form>
    </div>
    {% else %}
    <p>Bekleyen öğe yok.</p>
    {% endfor %}
</div>

<div class="card">
    <h3>Onaylananlar ({{ approved|length }})</h3>
    {% for item in approved %}
    <div style="border-bottom: 1px solid var(--border-color); padding: 10px 0;">
        <p><strong>URL:</strong> <a href="{{ item.target_url }}" target="_blank">{{ item.target_url }}</a></p>
        <p><strong>Yorum:</strong> {{ item.suggested_comment }}</p>
        <p><small>Onaylandı: {{ item.approved_at }} | {% if item.posted_at %}Gönderildi: {{ item.posted_at }}{% else %}<em>Gönderilmeyi bekliyor...</em>{% endif %}</small></p>
    </div>
    {% else %}
    <p>Onaylanmış öğe yok.</p>
    {% endfor %}
</div>
{% endblock %}